{% extends 'store/artisan_base.html' %}

{% block title %}Manage Coupons - Yarned with Love{% endblock %}

{% block artisan_content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="h4 fw-bold mb-0">Promo Codes ðŸŽ«</h2>
    <span class="badge bg-primary rounded-pill">{{ coupons.count }} Active</span>
</div>

<div class="row">
    <!-- Add Coupon Form -->
    <div class="col-md-4 mb-4">
        <div class="card border-0 shadow-sm rounded-4">
            <div class="card-header bg-white py-3 border-0">
                <h6 class="fw-bold mb-0">Create New Coupon</h6>
            </div>
            <div class="card-body">
                <form action="{% url 'add_coupon' %}" method="post">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label class="form-label small text-muted">Promo Code</label>
                        {{ form.code }}
                    </div>
                    <div class="mb-3">
                        <label class="form-label small text-muted">Discount (%)</label>
                        {{ form.discount_percentage }}
                    </div>
                    <div class="mb-3 form-check form-switch">
                        {{ form.active }}
                        <label class="form-check-label small" for="{{ form.active.id_for_label }}">Active</label>
                    </div>
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary rounded-pill">Create Coupon</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Coupons List -->
    <div class="col-md-8">
        <div class="card border-0 shadow-sm rounded-4">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="bg-light">
                            <tr>
                                <th class="border-0 ps-4 rounded-start">Code</th>
                                <th class="border-0">Discount</th>
                                <th class="border-0">Status</th>
                                <th class="border-0 pe-4 rounded-end text-end">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for coupon in coupons %}
                            <tr>
                                <td class="ps-4 fw-bold text-primary">{{ coupon.code }}</td>
                                <td><span class="badge bg-info text-dark">{{ coupon.discount_percentage }}% OFF</span>
                                </td>
                                <td>
                                    {% if coupon.active %}
                                    <span class="badge bg-success rounded-pill">Active</span>
                                    {% else %}
                                    <span class="badge bg-secondary rounded-pill">Inactive</span>
                                    {% endif %}
                                </td>
                                <td class="pe-4 text-end">
                                    <form action="{% url 'delete_coupon' coupon.pk %}" method="post" class="d-inline"
                                        onsubmit="return confirm('Delete this coupon?');">
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-sm btn-outline-danger border-0"><i
                                                class="bi bi-trash"></i></button>
                                    </form>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="4" class="text-center py-5 text-muted">No coupons created yet.</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}